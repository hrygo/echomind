# 📄 产品需求文档 - EchoMind

| 项目名称        | EchoMind                                                                     |
| :-------------- | :--------------------------------------------------------------------------- |
| **版本状态**    | **v1.1.1 (Enterprise Release)**                                              |
| **文档状态**    | **正式发布**                                                                 |
| **产品负责人**  | Product Team                                                                 |
| **核心 Slogan** | **EchoMind: The Neural Interface for Executive Work.** <br> (重塑决策直觉。) |

---

## 1. 战略定位与背景

### 1.1 产品愿景
EchoMind 是专为决策者打造的 **个人智能神经中枢 (Personal Neural Interface)**。

我们不重新发明工具，我们重新定义 **"掌控"**。
EchoMind 利用前沿 AI 技术 (RAG, Knowledge Graph)，**从你日常散布的各类信息流中（如通信、文档、日程）**提炼秩序与智慧，构建一个**专属的、可对话的数字大脑**。

它是你的**幕僚长**，也是你的**外脑**。无论是在电脑前的深度思考，还是移动端的即时灵感，EchoMind 让你跳过噪点，直抵本质，真正 **"重塑决策直觉"**。

### 1.3 目标用户与价值主张

EchoMind 服务于那些 **"Time-Poor, Influence-High" (时间匮乏，影响力高)** 的个体。我们不提供死板的工具，而是提供动态的 **"智能简报模板"**：

| 用户分层     | **The Executive (决策者)**                                                                        | **The Builder (管理者/实干家)**                                                         | **The Rainmaker (销售/投资人)**                                                             |
| :----------- | :------------------------------------------------------------------------------------------------ | :-------------------------------------------------------------------------------------- | :------------------------------------------------------------------------------------------ |
| **典型画像** | 创始人、合伙人、自由投资人                                                                        | 核心骨干、项目主理人                                                                    | 顶级销售、FA、独立顾问                                                                      |
| **核心痛点** | 没时间看细节，但绝不能漏掉风险。                                                                  | 事情太多太杂，害怕球在自己手里掉了。                                                    | 弱关系网庞大，难以捕捉每一个稍纵即逝的机会。                                                |
| **核心价值** | **“上帝视角 (God Mode)”**：<br>晨报模式自动聚合风险与决策项。<br>RAG 问答提供瞬间的全局信息检索。 | **“任务闭环 (Loop Closer)”**：<br>自动提取 To-Do 并同步。<br>微信一键指令处理日程冲突。 | **“机会雷达 (Opportunity Radar)”**：<br>自动识别购买/合作意图。<br>人脉图谱可视化沉睡关系。 |

---

## 2. 核心功能范围 (MVP)

### 2.1 数据采集层 (Cloud Native)
*   **协议支持**：
    *   **通用 IMAP/SMTP**：支持 99% 的企业邮箱（腾讯企业邮、阿里邮箱、网易、自建 Exchange）。
    *   **OAuth 2.0**：原生支持 Gmail、Outlook/Office 365（需申请 API 权限）。
*   **同步策略**：
    *   **元数据优先**：优先拉取信头（Sender, Subject, Date）构建索引。
    *   **按需拉取**：正文内容在分析时实时拉取或按策略预取。
    *   **历史回溯**：默认同步最近 30 天邮件，VIP 可配置全量。

### 2.2 AI 认知引擎 (The Brain)
*   **智能摘要 (Smart Briefing)**：
    *   单封邮件摘要：将长篇大论压缩为 3 行要点。
    *   **Thread 摘要**：将 20 封往来邮件（Re/Fwd）概括为“事件时间轴”和“当前状态”。
*   **实体与意图识别**：
    *   提取关键实体：金额、日期、地点、人名、公司。
    *   识别核心意图：`请求审批`、`安排会议`、`催促进度`、`投诉/不满`。
*   **情绪风控雷达**：
    *   分析发件人语气（愤怒、焦虑、急迫），对高风险邮件进行红色预警。
*   **多模型支持 (Model Agnostic)**：
    *   支持通过配置切换底层大模型（如 DeepSeek, OpenAI, Anthropic, Local LLMs）。
    *   根据任务复杂度自动路由（例如：简单分类用小模型，深度摘要用大模型）。
*   **RAG 与全知搜索 (Advanced RAG)**：
    *   **规约化向量架构 (v1.1.0+)**：采用固定 1024 维向量存储，确保性能一致性和存储效率。
    *   **向量存储 (Vector Store)**：采用 `pgvector` 存储邮件及附件的高维向量，构建私有知识库。
    *   **语义搜索 (Semantic Search)**：支持自然语言提问 ("上周关于 A 项目的预算讨论了什么？")，理解上下文而非仅匹配关键词。
    *   **精准引用 (Citations)**：搜索结果必须返回精确的 `Chunk ID` 和文本偏移量，支持前端 "Grounding Panel" 的原文溯源。
    *   **混合检索 (Hybrid Search)**：结合关键词匹配 (BM25) 与向量相似度，确保专有名词搜索的准确性。
    *   **多模态解析**：识别附件文档（PDF/Word）及图片中的关键信息。

### 2.3 用户界面：神经中枢 (Neural Interface - v1.1.1)
**核心理念**: 从 "Client" (客户端) 进化为 "Surface" (智能画布)。摒弃传统的文件夹列表，采用 **AI Native** 的 **Source-Canvas-Detail** 布局。

#### A. 布局架构 (The Fluid Canvas)
*   **左侧栏 (Context Manager)**:
    *   **动态关注点**: 自动聚合 "High Priority", "Pending Reply"。
    *   **用户上下文**: 用户勾选 "Project Alpha" 或 "Key Person: John"，AI 回答范围即锁定在该上下文内。
*   **主画布 (Intelligence Canvas)**:
    *   **Briefing Mode (晨报模式)**: 默认视图。类似于 Notion/Pinterest 的卡片流。根据用户角色自动渲染不同的 "Briefing Templates" (e.g., 高管看风险，销售看机会)。
    *   **Studio Mode (工作室模式)**: 问答视图。通过 AI Copilot 实现。用户提问，AI 实时生成回答，并支持流式输出和多模态组件渲染。
*   **右侧栏 (AI Copilot & Grounding)**:
    *   **AI Chat Copilot**: 右侧滑出的对话助手，支持基于 RAG 的多轮问答。
    *   **Smart Actions**: 邮件详情页自动提取的行动项（如“添加到日历”、“创建任务”），提供一键执行。

#### B. 生成式 UI 组件 (Generative Widgets)
系统根据意图自动渲染最佳交互组件，而非固定表单：
*   **Network Graph**: 当意图为 `relationship` 时渲染，展示人脉网络。
*   **Smart Action Buttons**: 在邮件详情中动态渲染行动按钮。

#### D. 微信公众号 (WeChat OS) - "随身第二大脑"
**定位**：EchoMind 的移动端对话式操作系统 (Conversational OS)，不仅仅是通知，更是核心交互界面。遵循 **"Lazy Intelligence" (懒人智能)** 哲学：零摩擦，高上下文。

*   **🎙️ 语音指挥官 (Voice Commander)**：
    *   **语音输入**：支持中英文自然语音输入 ("帮我回给 Alice 说下午三点可以")。
    *   **智能转录**：集成 Whisper 模型，精准识别专业术语。
    *   **多意图执行**：自动识别意图（查询、回复、摘要、朗读）并执行，返回语音或文字结果。
*   **🗓️ 日程守门人 (Calendar Gatekeeper)**：
    *   **冲突检测**：用户转发会议询问 ("下周二下午有空吗？")，AI 自动查日历检测冲突。
    *   **智能建议**：若有冲突，AI 自动寻找空闲时间槽并生成建议回复 ("周二不行，周三上午 10 点可以吗？")，一键复制发送。
*   **🧠 灵感捕手 (Thought Catcher)**：
    *   **极速录入**：随时语音记录闪念或待办 ("提醒我下周一和设计过一下红色按钮")。
    *   **结构化同步**：AI 自动提取 `Action`, `Deadline`, `Context` 并同步至 Web 端 Dashboard。
*   **⚡ 一键决策 (One-Touch Decision)**：
    *   **审批/决策卡片**：遇到需决策邮件（如预算审批），推送包含 `[ 🟢 批准 ]` `[ 🔴 驳回 ]` 按钮的卡片。
    *   **懒人操作**：用户无需打字，点击按钮即可完成回复或触发后续工作流。
*   **🔍 全知搜索 (RAG Search)**：
    *   **自然语言问答**：支持模糊查询 ("上个月张总关于预算说了什么？")，返回带引用的精准答案。

---

## 3. 非功能需求

### 3.1 安全与隐私 (最高优先级)
*   **SaaS 安全**：
    *   数据传输全链路 TLS 1.3 加密。
    *   数据库字段级加密（AES-256），密钥与数据分离存储。
*   **隐私模式 (Incognito Mode)**：
    *   提供“阅后即焚”选项：邮件正文仅在内存中进行 AI 分析，分析完成后立即释放，服务器仅存储摘要和结构化标签，不持久化存储原文。

### 3.2 性能要求
*   **秒级同步**：新邮件到达后 30 秒内完成 AI 分析并推送。
*   **海量吞吐**：支持单账户 10万+ 邮件索引。
*   **规约化架构 (v1.1.0+)**：固定向量维度提升查询性能和存储效率。

### 3.3 企业级可观测性 (v1.1.0+)
*   **结构化日志**：基于 YAML 的企业级日志配置，支持多进程日志管理。
*   **上下文追踪**：自动注入 trace_id、user_id、org_id 等上下文字段。
*   **企业集成**：支持 Elasticsearch、Grafana Loki、Splunk 等日志平台集成。
*   **采样策略**：生产环境支持日志采样，降低存储成本。

---

## 4. 商业模式 (规划中 - Deferred)
*   **Freemium (Future)**：
    *   免费版：连接 1 个邮箱，基础摘要，保留 30 天历史。
    *   Pro 版：无限邮箱，深度 AI 分析，无限历史，优先支持。
    *   Team 版：企业域管理，团队协作功能。

---

## 5. 风险评估
1.  **邮箱服务商限制**：部分邮箱（如 Gmail）对 API 调用频率有限制，需做好流控和重试机制。
2.  **用户信任**：SaaS 模式下，用户需输入邮箱密码/授权，需通过 SOC2 等合规认证建立信任。
3.  **AI 幻觉**：摘要可能遗漏关键细节，界面需提供“一键查看原文”的快速入口。