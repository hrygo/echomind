server:
  port: 8080
  environment: development  # Options: development, production
  jwt:
    secret: "your-jwt-secret-here"  # Replace with your actual JWT secret
    expiration_hours: 72

database:
  dsn: "host=localhost user=user password=password dbname=echomind_db port=5432 sslmode=disable"

security:
  encryption_key: "your-64-character-hex-encryption-key-here-replace-with-actual-key" # Replace with your actual 64-char hex key

redis:
  addr: "localhost:6380"
  password: ""
  db: 0

worker:
  concurrency: 10  # Number of concurrent task workers

# ==============================================================================
# AI Service Configuration (AI 服务配置)
# ==============================================================================
ai:
  # ---------------------------------------------------------------------------
  # 1. Service Routing (路由层)
  # ---------------------------------------------------------------------------
  # Designate which provider handles specific capabilities.
  # 指定由哪个注册的 Provider 负责具体的任务。
  active_services:
    chat: "deepseek"         # Responsible for Summarize, Classify, Draft Reply
    embedding: "siliconflow"   # Responsible for Vector Embeddings (RAG)

  chunk_size: 1000  # Max tokens per chunk for RAG processing

  # ---------------------------------------------------------------------------
  # 2. Provider Registry (能力注册表)
  # ---------------------------------------------------------------------------
  # Register any OpenAI-compatible or Google Gemini provider here.
  # No code changes required to add new vendors.
  # Embedding model dimensions must be configured accurately for database schema
  providers:

    # [Use Case: Cost-Effective & Smart]
    # DeepSeek via OpenAI Protocol
    deepseek:
      protocol: "openai"
      settings:
        base_url: "https://api.deepseek.com/v1"
        api_key: "your-deepseek-api-key-here"  # Replace with your DeepSeek API key
        model: "deepseek-chat"

    # siliconflow
    siliconflow:
      protocol: "openai"
      settings:
        base_url: "https://api.siliconflow.cn/v1"
        api_key: "your-siliconflow-api-key-here"  # Replace with your SiliconFlow API key
        model: "Qwen/Qwen3-235B-A22B"
        embedding_model: "Pro/BAAI/bge-m3"
        embedding_dimensions: 1024  # BGE-M3 outputs 1024 dimensions

    # [Use Case: Industry Standard]
    # Official OpenAI
    openai_small:
      protocol: "openai"
      settings:
        api_key: "your-openai-api-key-here"  # Replace with your OpenAI API key
        # This provider supports both Chat and Embedding
        model: "gpt-4o-mini"
        embedding_model: "text-embedding-3-small"
        embedding_dimensions: 1536  # text-embedding-3-small outputs 1536 dimensions

    # [Use Case: Multimodal Native]
    # Google Gemini
    gemini_flash:
      protocol: "gemini"
      settings:
        api_key: "your-gemini-api-key-here"  # Replace with your Google Gemini API key
        model: "gemini-2.5-flash"
        embedding_model: "text-embedding-004"
        embedding_dimensions: 768  # text-embedding-004 outputs 768 dimensions

    # [Use Case: Local Privacy / Offline]
    # Ollama (running locally)
    # Requires: `ollama run llama3` and `ollama run nomic-embed-text`
    local_ollama:
      protocol: "openai"
      settings:
        base_url: "http://localhost:11434/v1"
        api_key: "ollama" # Any string works
        model: "llama3"
        embedding_model: "nomic-embed-text"
        embedding_dimensions: 768  # nomic-embed-text outputs 768 dimensions

    # [Use Case: Other OpenAI-Compatible Vendors]
    # Example: Moonshot / Kimi, SiliconFlow, Groq
    moonshot_kimi:
      protocol: "openai"
      settings:
        base_url: "https://api.moonshot.cn/v1"
        api_key: "your-moonshot-api-key-here"  # Replace with your Moonshot API key
        model: "moonshot-v1-8k"

    # [Use Case: Testing]
    mock:
      protocol: "mock"
      settings:
        embedding_dimensions: 1024  # Mock uses 1024 dimensions by default

  # ---------------------------------------------------------------------------
  # 3. Prompt Templates (提示词模板)
  # ---------------------------------------------------------------------------
  # Guidelines for modifying prompts:
  # 1. Output JSON strictly where requested.
  # 2. Do not change the JSON keys (summary, category, etc.) as the backend parses them.
  prompts:

    # Input: Email Content (Text)
    # Output: JSON Structure
    summary: |
      你是一位专业的行政助理。你的目标是分析以下邮件，并返回一个结构化的 JSON 对象，包含以下字段：
      - "summary": 用中文简明扼要地总结邮件内容（3句话以内），突出关键行动、决策或信息。
      - "category": 将邮件归类为以下之一：'Work' (工作), 'Newsletter' (通讯), 'Notification' (通知), 'Personal' (个人), 'Spam' (垃圾邮件)。请返回英文类别名称。
      - "sentiment": 确定整体情感：'Positive' (积极), 'Neutral' (中性), 'Negative' (消极)。请返回英文情感名称。
      - "urgency": 确定紧急程度：'High' (高), 'Medium' (中), 'Low' (低)。请返回英文紧急程度名称。
      - "action_items": 提取邮件中的待办事项或行动项列表（中文）。如果没有，返回空数组。
      - "smart_actions": 分析邮件中是否包含具体的会议邀请、任务截止日期或需要添加到日历/待办的事项。如果是，请生成一个对象数组。支持的类型：'calendar_event' (日历事件), 'create_task' (创建任务)。如果没有，返回空数组。

      Smart Action 格式示例：
      ```json
      {
        "smart_actions": [
          {
            "type": "calendar_event",
            "label": "添加到日历",
            "data": {
              "title": "项目周会",
              "start": "2023-10-27 10:00",
              "end": "2023-10-27 11:00",
              "location": "Zoom"
            }
          },
          {
            "type": "create_task",
            "label": "创建待办",
            "data": {
              "title": "提交财务报表",
              "deadline": "2023-10-30"
            }
          }
        ]
      }
      ```
      请勿包含任何对话填充词。示例输出：
      ```json
      {
        "summary": "这是一个关于邮件内容的简明总结。",
        "category": "Work",
        "sentiment": "Neutral",
        "urgency": "Medium",
        "action_items": ["跟进项目X"],
        "smart_actions": []
      }
      ```

    # Input: Email Content (Text)
    # Output: String (Category Name)
    classify: "将以下邮件归类为以下之一：'Work', 'Newsletter', 'Notification', 'Personal', 'Spam'。仅返回类别名称（英文）。"

    # Input: Email Content (Text)
    # Output: JSON Structure
    sentiment: '分析以下邮件的情感和紧急程度。返回 JSON 格式结果：{"sentiment": "Positive" | "Neutral" | "Negative", "urgency": "High" | "Medium" | "Low"}。'

    # Input: Original Email + User Prompt
    # Output: String (Draft Email Body)
    draft_reply: |
      你是一位高效的职业经理人。请根据原始邮件内容和用户的简短提示，用中文起草一封专业、得体且切中要点的回复邮件。
      保持语气专业、友好。如果用户提示很简略，请根据上下文合理补充。